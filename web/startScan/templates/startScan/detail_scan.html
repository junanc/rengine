{% extends 'base/base.html' %}
{% load static %}
{% load humanize %}
{% load custom_tags %}
{% load mathfilters %}
{% block title %}
Detailed Scan
{% endblock title %}

{% block custom_js_css_link %}
<link rel="stylesheet" type="text/css" href="{% static 'plugins/datatable/datatables.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/datatable/global.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/datatable/custom.css' %}">
<link href="{% static 'plugins/select2/select2.min.css' %}" rel="stylesheet" type="text/css" />
<link href="{% static 'plugins/perfect-scrollbar/perfect-scrollbar.css' %}" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="{% static 'plugins/gridzy/gridzy.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/gridzy/skins/gridzySkinBlank/style.css' %}">
<link href="{% static 'plugins/lightbox/css/lightbox.css' %}" rel="stylesheet" />
<script src="{% static 'plugins/gridzy/gridzy.js' %}"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://cdn.rawgit.com/eligrey/canvas-toBlob.js/f1a01896135ab378aa5c0118eadd81da55e698d8/canvas-toBlob.js"></script>
<script src="https://cdn.rawgit.com/eligrey/FileSaver.js/e9d941381475b5df8b7d7691013401e171014e89/FileSaver.min.js"></script>
{% endblock custom_js_css_link %}

{% block breadcrumb_title %}
<!-- <li class="breadcrumb-item"><a href="{% url 'scan_history' %}">Scan History</a></li>
<li class="breadcrumb-item active">Summary</li>
<li class="breadcrumb-item active" aria-current="page">{{history.domain.name}}</li> -->
{% endblock breadcrumb_title %}

{% block page_title %}
<!-- Scan Findings  -->
{% endblock page_title %}

{% block main_content %}
<span aria-current="page" style="display: none">{{history.domain.name}}</span>
<div class="row">
	<div class="col-12">
		<div class="card">
			<ul class="nav nav-tabs nav-bordered m-1">
				<li class="nav-item">
					<a class="nav-link" id="pills-summary-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#summary-tab">Home</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" id="pills-subdomain-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#subdomain-tab">Subdomains</a>
				</li>
				<li class="nav-item interesting-tab-show" style="display: none">
					<a class="nav-link" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#interesting-tab">Interesting Recon</a>
				</li>
				<li class="nav-item recon-changes-tab-show" style="display: none">
					<a class="nav-link" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#recon-changes-tab">Recon Data Changes</a>
				</li>
				{% if history.screenshot %}
				<li class="nav-item">
					<a class="nav-link" id="pills-screenshot-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#screenshot-tab">Screenshots</a>
				</li>
				{% endif %}
				{% if history.dir_file_search %}
				<li class="nav-item">
					<a class="nav-link" id="pills-directories-tab" data-bs-toggle="tab" aria-expanded="false" href="#directories-tab">Directories</a>
				</li>
				{% endif %}
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">URLs&nbsp;<i class="fe-chevron-down"></i></a>
					<ul class="dropdown-menu" style="width: 240px;">
						<li><a class="dropdown-item" id="pills-endpoints-tab" href="#endpoints-tab" data-bs-toggle="tab" aria-expanded="false">All Endpoints</a></li>
						{% if history.fetch_url and history.used_gf_patterns%}
						{% for key,value in matched_gf_count.items %}
						{% if value > 0 %}
						<li><a class="dropdown-item" id="pills-{{key}}-tab" href="#endpoints-tab" data-bs-toggle="tab" aria-expanded="false">{{key|upper}}<span class="badge-soft-danger float-end ms-1 ps-1 pe-1">{{value}}</span></a></li>
						{% endif %}
						{% endfor %}
						{% endif %}
					</ul>
				</li>
				{% if history.vulnerability_scan %}
				<li class="nav-item">
					<a class="nav-link" id="pills-vulnerabilities-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#vulnerabilities-tab">Vulnerabilities</a>
				</li>
				{% endif %}
				{% if history.osint %}
				<li class="nav-item">
					<a class="nav-link" id="pills-osint-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#osint-tab">OSINT</a>
				</li>
				{% endif %}
				<li class="nav-item">
					<a class="nav-link" id="pills-visualisation-tab" data-bs-toggle="tab" aria-expanded="false" class="nav-link" href="#visualisation-tab">Visualization</a>
				</li>
			</ul>
		</div>
	</div>
</div>
<div class="tab-content no-padding-tab">
	<!-- start tab contents  -->
	{# <div class="tab-pane show active" id="summary-tab"> #}
	<div class="tab-pane" id="summary-tab">
		<div class="row">
			<div class="col-xl-3 col-lg-4">
				<div class="card">
					<div class="card-body">
						<div class="d-flex align-items-start mb-3">
							<div class="w-100">
								<h5 class="mt-0 mb-0 font-15">
									Scan Status for <span class="badge badge-soft-primary">{{history.domain.name}}</span>
								</h5>
								<p class="mt-1 mb-0 text-muted font-14">
									{% if history.scan_status == -1 %}
									<span class="mdi mdi-circle text-warning"></span>
									<span class="badge badge-soft-warning">Pending</span>
									{% elif history.scan_status == 0 %}
									<span class="mdi mdi-circle text-danger"></span>
									<span class="badge badge-soft-danger">Failed</span>
									{% elif history.scan_status == 1 %}
									<span class="mdi mdi-circle text-warning"></span>
									<span class="badge badge-soft-warning">In Progress</span>
									{% elif history.scan_status == 2 %}
									<span class="mdi mdi-circle text-success"></span>
									<span class="badge badge-soft-success">Completed</span>
									{% elif history.scan_status == 3 %}
									<span class="mdi mdi-circle text-danger"></span>
									<span class="badge badge-soft-danger">Aborted</span>
									{% else %}
									<span class="mdi mdi-circle text-danger"></span>
									<span class="badge badge-danger">Unknown</span>
									{% endif %}
								</p>
							</div>
							<div class="btn-group mb-2">
								<a href="#" class="text-dark dropdown-toggle float-end" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<i class="fe-more-vertical"></i>
								</a>
								<div class="dropdown-menu" style="">
									<a class="dropdown-item" href="javascript:download_subdomains({{scan_history_id}}, '{{history.domain.name}}')">Download All Subdomains</a>
									<a class="dropdown-item" href="javascript:download_endpoints({{scan_history_id}}, '{{history.domain.name}}')">Download All Endpoints</a>
									<a class="dropdown-item" href="javascript:download_important_subdomains({{scan_history_id}}, '{{history.domain.name}}');">Download Important Subdomains</a>
									<a class="dropdown-item" href="javascript:download_interesting_subdomains({{scan_history_id}}, '{{history.domain.name}}');">Download Interesting Subdomains</a>
									<a class="dropdown-item" href="javascript:download_interesting_endpoints({{scan_history_id}}, '{{history.domain.name}}');">Download Interesting Endpoints</a>
								</div>
							</div>
						</div>
						<h6 class="font-13 text-muted text-uppercase">Scan Engine <span class="badge badge-soft-primary float-end">{{history.scan_type.engine_name}}</span></h6>
						<h6 class="font-13 text-muted text-uppercase mt-3">Scan Duration </h6>
						{% if history.scan_status == -1 %}
						<p class="mt-1 mb-0 text-warning font-14"><small class="text-center text-muted">Scan not yet started.</small></p>
						{% elif history.scan_status == 0 %}
						<span class="mt-1 mb-0 text-danger font-14">{{ history.start_scan_date|timesince:history.stop_scan_date }}</span>
						{% elif history.scan_status == 1 %}
						<span class="mt-1 mb-0 text-primary font-14">{{ history.get_elapsed_time }}</span>
						{% elif history.scan_status == 2 %}
						{% if history.get_total_scan_time_in_sec < 60 %}
						<span class="mt-1 mb-0 text-success font-14">Completed in < 1 minutes</span>
						{% else %}
						<span class="mt-1 mb-0 text-success font-14">Completed in {{ history.start_scan_date|timesince:history.stop_scan_date }}</span>
						{% endif %}
						{% elif history.scan_status == 3 %}
						<span class="mt-1 mb-0 text-danger font-14">Aborted in {{ history.start_scan_date|timesince:history.stop_scan_date }}</span>
						{% endif %}


						<h3 class="font-13 text-muted text-uppercase mb-2">Scan Progress</h3>
						<div class="progress mb-2 progress-md">
							{% if history.scan_status == -1 %}
							<div class="progress-bar bg-warning" role="progressbar" style="width: 10%" aria-valuemin="0" aria-valuemax="100">
							</div>
							{% elif history.scan_status == 0 %}
							<div class="progress-bar bg-danger" role="progressbar" style="width: {% widthratio history.scanactivity_set.all|length history.scan_type.get_number_of_steps|add:4  100 %}%" aria-valuemin="0" aria-valuemax="4">
							</div>
							{% elif history.scan_status == 1 %}
							<div class="progress-bar bg-primary progress-bar-striped progress-bar-animated" role="progressbar" style="width: {% widthratio history.scanactivity_set.all|length history.scan_type.get_number_of_steps|add:4  100 %}%" aria-valuemin="0" aria-valuemax="4">
							</div>
							{% elif history.scan_status == 2 %}
							<div class="progress-bar bg-success" role="progressbar" style="width: 100%" aria-valuemin="0" aria-valuemax="100">
							</div>
							{% elif history.scan_status == 3 %}
							<div class="progress-bar bg-danger" role="progressbar" style="width: {% widthratio history.scanactivity_set.all|length history.scan_type.get_number_of_steps|add:4  100 %}%" aria-valuemin="0" aria-valuemax="4">
							</div>
							{% else %}
							<div class="progress">
								<div class="progress-bar bg-danger" role="progressbar" style="width: 100%" aria-valuemin="0" aria-valuemax="100">
								</div>
							</div>
							{% endif %}
						</div>

						{% if  history.domain.get_organization %}
						<h3 class="font-13 text-muted text-uppercase mb-2">Tagged to Organization</h3>
						{% for organization in history.domain.get_organization %}
						<span class="badge badge-soft-dark m-1" data-toggle="tooltip" data-placement="top" title="Domain {{domain.name}} belongs to organization {{organization.name}}">{{ organization.name }}</span>
						{% endfor %}
						{% endif %}

						<h6 class="font-13 text-muted text-uppercase mt-4 mb-2">Scan Timeline</h6>
						<div data-simplebar style="max-height: 410px;" class="p-2">
							<div class="track-order-list">
								<ul class="list-unstyled">
									{% for activity in scan_activity %}
									<li class="completed">
										<h5 class="mt-0 mb-1">{{activity.title}}
											<span class="float-end badge {% if activity.status == 0 %}badge-soft-danger {% elif activity.status == 1 %}badge-soft-warning{% elif activity.status == 2 %}badge-soft-success{% endif %}">
												{% if activity.status == 0 %}Failed
												{% elif activity.status == 1 %}In progress<span class="active-dot dot"></span>
												{% elif activity.status == 2 %}Completed
												{% endif %}
											</span>
										</h5>
										<p class="text-muted">{{activity.time|naturaltime}}<br><small class="text-muted">{{activity.time}}</small> </p>
									</li>
									{% endfor %}
								</ul>
							</div>
						</div>
					</div>
				</div>
				<div class="card">
					<div class="card-body">
						<div class="d-flex align-items-start mb-3">
							<div class="w-100">
								<h5 class="mt-0 mb-0 font-15">
									Recent Scans for <span class="badge badge-soft-primary">{{history.domain.name}}</span>
								</h5>
								<div class="track-order-list mt-3">
									<ul class="list-unstyled">
										{% for scan in most_recent_scans %}
										<li class="completed">
											<a href="{% url 'detail_scan' scan.id %}">
												<h5 class="mt-0 mb-1">{{activity.title}}
													{% if history.id == scan.id %}
													<span class="active-dot dot"></span>
													<span class="float-start badge badge-soft-primary ms-1 me-1">Current Scan</span>
													{% endif %}
													{{scan.scan_type.engine_name}}
													{% if scan.scan_status == -1 %}
													<span class="badge badge-soft-warning float-end">Pending</span>
													{% elif scan.scan_status == 0 %}
													<span class="badge badge-soft-danger float-end">Failed</span>
													{% elif scan.scan_status == 1 %}
													<span class="badge badge-soft-primary float-end">Scanning</span>
													{% elif scan.scan_status == 2 %}
													<span class="badge badge-soft-success float-end">Completed</span>
													{% elif scan.scan_status == 3 %}
													<span class="badge badge-soft-danger float-end">Aborted</span>
													{% else %}
													<span class="badge badge-soft-danger float-end">Unknown</span>
													{% endif %}
												</h5>
												<p class="text-muted">{{scan.start_scan_date|naturaltime}}<br><small class="text-muted">{{scan.start_scan_date}}</small></p>
												<p class="text-primary">
													{{scan.get_subdomain_count}} Subdomains Discovered
													<span class="float-end text-dark">
														{% with next_element=most_recent_scans|next:forloop.counter0 %}
														{% if next_element.get_subdomain_count and scan.get_subdomain_count and next_element.get_subdomain_count > scan.get_subdomain_count %}
														<span class="text-danger" data-toggle="tooltip" data-placement="top" title="{{scan.get_subdomain_count|sub:next_element.get_subdomain_count|abs}} subdomains missing since last scan."><i class="fa fa-caret-down text-danger me-1"></i>{{scan.get_subdomain_count|sub:next_element.get_subdomain_count}} Subdomains</span>
														{% elif next_element.get_subdomain_count and scan.get_subdomain_count and next_element.get_subdomain_count < scan.get_subdomain_count %}
														<span class="text-success" data-toggle="tooltip" data-placement="top" title="{{scan.get_subdomain_count|sub:next_element.get_subdomain_count}} subdomains added since last scan."><i class="fa fa-caret-up text-success me-1"></i>{{scan.get_subdomain_count|sub:next_element.get_subdomain_count}} Subdomains</span>
														{% endif %}
														{% endwith %}
													</span>
												</p>
											</a>
										</li>
										{% endfor %}
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-xl-9 col-lg-8">
				<div class="row">
					<div class="col-xl-3 col-lg-3 col-6">
						<div class="card" id="tooltip-container">
							<div class="card-body">
								<i class="fa fa-info-circle text-muted float-end" data-bs-container="#tooltip-container" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Total Subdomains Discovered by reNgine during this scan"></i>
								<h4 class="mt-0 font-16">Subdomains Discovered</h4>
								<h2 class="text-primary my-3 text-center"><span data-plugin="counterup">{{subdomain_count|intcomma}}</span></h2>
								<p class="mb-0"><span class="badge badge-soft-success">Alive Subdomains: {{alive_count}}</span></p>
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-lg-3 col-6">
						<div class="card" id="tooltip-container1">
							<div class="card-body">
								<i class="fa fa-info-circle text-muted float-end" data-bs-container="#tooltip-container1" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Total Endpoints discovered by reNgine during this scan. This includes any URLs discovered."></i>
								<h4 class="mt-0 font-16">Endpoints Discovered</h4>
								<h2 class="text-primary my-3 text-center"><span data-plugin="counterup">{{endpoint_count|intcomma}}</span></h2>
								<p class="text-success mb-0"><span class="badge badge-soft-success">Alive Endpoints: {{endpoint_alive_count}}</span></p>
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-lg-3 col-6">
						<div class="card" id="tooltip-container2">
							<div class="card-body">
								<i class="fa fa-info-circle text-muted float-end" data-bs-container="#tooltip-container2" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Total Vulnerabilities discovered by reNgine. This will be populated only if vulnerability scan is performed during this scan."></i>
								<h4 class="mt-0 font-16">Vulnerabilities Discovered</h4>
								<h2 class="text-danger my-3 text-center"><span data-plugin="counterup">{{total_vulnerability_count|intcomma}}</span></h2>
								{% if history.vulnerability_scan %}
								<p class="text-muted mb-0">
									<span class="w-title text-danger">{{critical_count}} Critical, {{high_count}} High, {{medium_count}} Medium</span>
									<span class="w-title text-warning">and {{low_count}} Low Vulnerabilities</span>
								</p>
								{% else %}
								<p class="text-muted mb-0 small">Vulnerability scan hasn't been performed.</p>
								{% endif %}
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-lg-3 col-6">
						<div class="card" id="tooltip-container3">
							<div class="card-body">
								<i class="fa fa-info-circle text-muted float-end" data-bs-container="#tooltip-container3" data-bs-toggle="tooltip" data-bs-placement="bottom" title="OSINT Results"></i>
								<h4 class="mt-0 font-16">OSINT</h4>
								{% if history.osint %}
								<h5 class="text-warning">{{exposed_count}} Exposed Credentials</h5>
								<p class="text-muted mb-0">{{email_count}} Email Address Discovered</p>
								<p class="text-muted mb-0">{{employees_count}} Employees Found</p>
								<br>
								{% else %}
								<h5 class="text-warning">&nbsp;</h5>
								<p class="text-muted mb-0">OSINT hasn't been performed.</p>
								<p class="text-muted mb-0">&nbsp;</p>
								<br>
								{% endif %}
							</div>
						</div>
					</div>
					<div class="col-6 interesting-tab-show" style="display: none">
						<div class="alert alert-warning alert-dismissible fade show" role="alert">
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							<i class="mdi mdi-fire-alert me-2"></i> reNgine identified <span id="interesting_subdomain_alert_count"></span> <span id="interesting_endpoint_alert_count"></span> <a class="alert-link" id="interesting-tab-btn" href="#">Check it out!</a>
						</div>
					</div>
					<div class="col-6 recon-changes-tab-show" style="display: none">
						<div class="alert alert-warning alert-dismissible fade show" role="alert">
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							<i class="fe-trending-up me-2"></i> <span id="subdomain_changes_alert"></span> <a class="alert-link" id="recon-changes-tab-btn" href="#">Check it out!</a>
						</div>
					</div>
					<div class="col-xl-7 col-lg-7 col-12">
						<div class="card" style="height: 95%">
							<div class="card-body">
								<div class="card-widgets">
									<a href="javascript: fetch_whois('{{history.domain}}');" data-toggle="tooltip" title="Reload Whois"><i class="mdi mdi-refresh"></i></a>
								</div>
								<h4 class="header-title mb-0"><i class="fe-activity"></i>&nbsp;Target Information</h4>
								<div class="row mt-3">
									<div class="col-sm-3">
										<div class="nav flex-column nav-pills nav-pills-tab" id="v-pills-tab" role="tablist" aria-orientation="vertical">
											<a class="nav-link active show mb-1" id="v-pills-domain-tab" data-bs-toggle="pill" href="#v-pills-domain" role="tab" aria-controls="v-pills-domain-tab" aria-selected="true">Domain info</a>
											<a class="nav-link mb-1" id="v-pills-whois-tab" data-bs-toggle="pill" href="#v-pills-whois" role="tab" aria-controls="v-pills-whois" aria-selected="false">Whois</a>
											<a class="nav-link mb-1" id="v-pills-nameserver-tab" data-bs-toggle="pill" href="#v-pills-nameserver" role="tab" aria-controls="v-pills-nameserver"aria-selected="false">Nameservers</a>
											<a class="nav-link mb-1" id="v-pills-history-tab" data-bs-toggle="pill" href="#v-pills-history" role="tab" aria-controls="v-pills-history"aria-selected="false">NS History</a>
										</div>
									</div> <!-- end col-->
									<div class="col-sm-9">
										<div class="tab-content pt-0">
											<div class="tab-pane fade active show" id="v-pills-domain" role="tabpanel" aria-labelledby="v-pills-domain-tab" data-simplebar style="max-height: 300px; min-height: 300px;">
												{% if not history.domain.domain_info %}
												<div class="alert alert-danger alert-dismissible fade show" role="alert" id="whois_not_fetched_alert">
													<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
													WHOIS Record Has not been fetched, would you like to <a href="javascript: fetch_whois('{{history.domain}}');">fetch it now?</a>
												</div>
												{% endif %}
												<div class="alert alert-info alert-dismissible fade show" role="alert" id="whois_fetching_alert" style="display: none">
													Fetching WHOIS records, Please wait...
													<div class="spinner-border spinner-border-sm float-end" role="status"></div>
												</div>
												<div class="alert alert-success alert-dismissible fade show" role="alert" id="whois_fetched_alert" style="display: none">
													WHOIS Records have been fetched, please <a href="javascript:location.reload();">reload the page.</a>
												</div>
												<h4 class="header-title">Domain Information</h4>
												<table class="domain_details_table table table-hover table-borderless">
													<tr style="display: none">
														<th>&nbsp;</th>
														<th>&nbsp;</th>
													</tr>
													<tr>
														<td>Domain Name</td>
														<td>{{history.domain.name}}</td>
													</tr>
													<tr>
														<td>Domain age</td>
														<td id="domain_age"></td>
													</tr>
													<tr>
														<td>IP Address</td>
														<td id="ip_address">{{history.domain.domain_info.ip_address}}</td>
													</tr>
													<tr>
														<td>IP Geolocation</td>
														<td id="ip_geolocation">{% if history.domain.domain_info.geolocation_iso %}<img src="https://domainbigdata.com/img/flags-iso/flat/24/{{history.domain.domain_info.geolocation_iso}}.png" alt="{{history.domain.domain_info.geolocation_iso}}">{% endif %} {{history.domain.domain_info.geolocation}}</td>
													</tr>
												</table>
												<h4 class="header-title mt-3">Registrant Information</h4>
												<table class="domain_details_table table table-hover table-borderless">
													<tr style="display: none">
														<th>&nbsp;</th>
														<th>&nbsp;</th>
													</tr>
													<tr>
														<td>Name</td>
														<td id="registrant_name">{{history.domain.domain_info.whois.registrant.name}}</td>
													</tr>
													<tr>
														<td>Organization</td>
														<td id="registrant_organization">{{history.domain.domain_info.whois.registrant.organization}}</td>
													</tr>
													<tr>
														<td>Address</td>
														<td id="registrant_address">{% if history.domain.domain_info.whois.registrant.country_iso %}<img src="https://domainbigdata.com/img/flags-iso/flat/24/{{history.domain.domain_info.whois.registrant.country_iso}}.png" alt="{{history.domain.domain_info.whois.registrant.country_iso}}">{% endif %} {{history.domain.domain_info.whois.registrant.address}} {{history.domain.domain_info.whois.registrant.City}} {{history.domain.domain_info.whois.registrant.state}} {{history.domain.domain_info.whois.registrant.country}}</td>
													</tr>
													<tr>
														<td>Phone Numbers</td>
														<td id="registrant_phone_numbers">{{history.domain.domain_info.whois.registrant.phone_number}}</td>
													</tr>
													<tr>
														<td>Fax</td>
														<td id="registrant_fax">{{history.domain.domain_info.whois.registrant.fax}}</td>
													</tr>
												</table>
											</div>
											<div class="tab-pane fade" id="v-pills-whois" role="tabpanel" aria-labelledby="v-pills-whois-tab">
												<pre data-simplebar style="max-height: 310px; min-height: 310px;">{{history.domain.domain_info.whois.details}}</pre>
											</div>
											<div class="tab-pane fade" id="v-pills-history" role="tabpanel" aria-labelledby="v-pills-history-tab" data-simplebar style="max-height: 300px; min-height: 300px;">
												{% if history.domain.domain_info.nameserver_history.all %}
												<table class="table table-striped mb-0">
													<thead class="table-dark">
														<td>Date</td>
														<td>Action</td>
														<td>NameServer</td>
													</thead>
													<tbody>
														{% for history in history.domain.domain_info.nameserver_history.all %}
														<tr>
															<td>{{history.date}}</td>
															<td>{{history.action}}</td>
															<td>{{history.server}}</td>
														</tr>
														{% endfor %}
													</tbody>
												</table>
												{% else %}
												No DNS history records found.
												{% endif %}
											</div>
											<div class="tab-pane fade" id="v-pills-nameserver" role="tabpanel" aria-labelledby="v-pills-nameserver-tab" data-simplebar style="max-height: 300px; min-height: 300px;">
												{% if history.domain.domain_info.nameserver_record.all %}
												<table class="table table-striped mb-0">
													<thead class="table-dark">
														<td>Type</td>
														<td>Hostname</td>
														<td>Address</td>
														<td>TTL</td>
														<td>Class</td>
														<td>Preference</td>
													</thead>
													<tbody>
														{% for nameserver in history.domain.domain_info.nameserver_record.all %}
														<tr>
															<td><span class="badge badge-soft-primary me-1 ms-1">{{ nameserver.type}}</span></td>
															<td>{{nameserver.hostname}}</td>
															<td>{{nameserver.address}}</td>
															<td>{{nameserver.ttl}}</td>
															<td>{{nameserver.ns_class}}</td>
															<td>{% if nameserver.preference %}{{nameserver.preference}}{% endif %}</td>
														</tr>
														{% endfor %}
													</tbody>
												</table>
												{% else %}
												No DNS history records found.
												{% endif %}
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-5 col-lg-5 col-12">
						<div class="card" style="height: 95%">
							<div class="card-body">
								<h4 class="header-title mb-0">HTTP Status Breakdown</h4>
								<div id="http_status_chart" class="apex-charts"></div>
							</div>
						</div>
					</div>
					{% if history.vulnerability_scan %}
					<div class="col-xl-5 col-lg-5 col-12">
						<div class="card" style="height: 95%">
							<div class="card-body">
								<h4 class="header-title mb-0">Vulnerability Breakdown by Severity</h4>
								<div id="cardCollpase19" class="collapse pt-3 show" dir="ltr">
									<div class="row mt-3 text-center">
										<div class="col-3">
											<p class="text-critical font-15 mb-1 text-truncate">Critical</p>
											<h4 class="text-critical">{{critical_count}}</h4>
										</div>
										<div class="col-3">
											<p class="text-danger font-15 mb-1 text-truncate">High</p>
											<h4 class="text-danger">{{high_count}}</h4>
										</div>
										<div class="col-3">
											<p class="text-warning font-15 mb-1 text-truncate">Medium</p>
											<h4 class="text-warning">{{medium_count}}</h4>
										</div>
										<div class="col-3">
											<p class="text-low font-15 mb-1 text-truncate">Low</p>
											<h4 class="text-low">{{low_count}}</h4>
										</div>
									</div>
									<div id="vulnerability-pie-chart" class="apex-charts"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-7 col-lg-7 col-12">
						<div class="card" style="height: 95%">
							<div class="card-body">
								<h4 class="header-title mb-3">Vulnerability Highlights</h4>
								<div class="inbox-widget table-responsive" data-simplebar style="max-height: 407px;">
									<table class="table table-borderless table-nowrap table-hover table-centered m-0">
										<thead class="table-light">
											<tr>
												<th style="width: 40%">Vulnerability</th>
												<th style="width: 10%">Severity</th>
												<th style="width: 50%">Vulnerable URL</th>
											</tr>
										</thead>
										<tbody>
											{% for vulnerability in vulnerability_list %}
											<tr>
												<td>{{vulnerability.name}}<br><small class="text-muted">Discovered: {{vulnerability.discovered_date|naturaltime}}</small></td>
												<td>{% if vulnerability.severity == 0 %}
													<span class='badge badge-soft-info'>Info</span>
													{% elif vulnerability.severity == 1 %}
													<span class='badge badge-soft-low'>Low</span>
													{% elif vulnerability.severity == 2 %}
													<span class='badge badge-soft-warning'>Medium</span>
													{% elif vulnerability.severity == 3 %}
													<span class='badge badge-soft-danger'>High</span>
													{% elif vulnerability.severity == 4 %}
													<span class='badge badge-critical'>Critical</span>
													{% endif %}
												</td>
												<td><a href="{{vulnerability.http_url}}" target="_blank" class="text-danger bs-tooltip" title="{{vulnerability.http_url}}">{{vulnerability.http_url|truncatechars:50}}</a></td>
											</tr>
											{% empty %}
											Not enough data.
											{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					{% endif %}
					<div class="col-xl-6 col-lg-6 col-12">
						<div class="card">
							<div class="card-body">
								<h4 class="header-title mb-0"><span id="important-count"><span class="spinner-border spinner-border-sm me-1"></span></span>Important Subdomains</h4>
								<div class="p-2" data-simplebar style="max-height: 235px; min-height: 235px;">
									<div id="important-subdomains-list">
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-6 col-lg-6 col-12">
						<div class="card">
							<div class="card-body">
								<h4 class="header-title mb-0"><span id="tasks-count"><span class="spinner-border spinner-border-sm me-1"></span></span>
									Recon Note/Todo
									<span class="text-primary float-end" data-toggle="tooltip" data-placement="top" title="Add Recon Todo" onclick="add_todo_for_scanhistory_modal({{history.id}})">
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
									</span>
								</h4>
								<div class="p-2">
									<div style="max-height: 210px;min-height: 210px;" data-simplebar>
										<ul class="list-group list-group-flush todo-list" id="todo-list"></ul>
									</div>
								</div>
								<div class="modal fade" id="addTaskModal" tabindex="-1" role="dialog" aria-labelledby="addTaskModalTitle" aria-hidden="true">
									<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
										<div class="modal-content">
											<div class="modal-body">
												<div class="compose-box">
													<div class="compose-content" id="addTaskModalTitle">
														<h4 class="header-title">Add Recon Todo</h4>
														<form>
															<input type="hidden" name="summary_identifier" value="{{history.id}}" id="summary_identifier_val">

															<div class="mt-2">
																<label for="todoTitle" class="form-label">Todo Title</label>
																<input id="todoTitle" type="text" placeholder="Todo Title" class="form-control" name="task">
															</div>

															<div class="mt-2">
																<label for="todoSubdomainDropdown" class="form-label">Select Subdomain (Optional)</label>
																<span id="selectedSubdomainCount"></span>
																<select class="w-100 form-control" data-toggle="select2" data-width="100%" id="todoSubdomainDropdown">
																	<option>Choose Subdomain...</option>
																</select>
															</div>

															<div class="">
																<label for="todoDescription" class="form-label">Todo Description (Optional)</label>
																<textarea class="form-control" id="todoDescription" rows="5" spellcheck="false" placeholder="Todo Description"></textarea>
															</div>
														</form>
													</div>
												</div>
											</div>
											<div class="modal-footer">
												<button class="btn btn-primary add-scan-history-todo">Add Recon Todo</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-4 col-lg-4 col-12">
						<div class="card">
							<div class="card-body">
								<h4 class="header-title mb-0"><span id="ip-address-count"><span class="spinner-border spinner-border-sm me-1"></span></span> IP Addresses</h4>
								<span class="text-warning float-end">*IP Addresses highlighted with yellow are CDN IP</span>
								<div class="p-2" data-simplebar style="max-height: 235px; min-height: 235px;">
									<div id="ip-address" class="mt-2"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-4 col-lg-4 col-12">
						<div class="card">
							<div class="card-body">
								<h4 class="header-title mb-0"><span id="ports-count"><span class="spinner-border spinner-border-sm me-1"></span></span> Discovered Ports</h4>
								<span class="text-danger float-end">*Ports highlighted with red are uncommon Ports</span>
								<div class="p-2" data-simplebar style="max-height: 235px; min-height: 235px;">
									<div id="ports" class="mt-2"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-4 col-lg-4 col-12">
						<div class="card">
							<div class="card-body">
								<h4 class="header-title mb-0"><span id="technologies-count"><span class="spinner-border spinner-border-sm me-1"></span></span> Discovered Technologies</h4>
								<span class="text-warning float-end">&nbsp;</span>
								<div class="p-2" data-simplebar style="max-height: 235px; min-height: 235px;">
									<div id="technologies" class="mt-2"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="tab-pane show active" id="subdomain-tab">
		<div class="row justify-content-center">
			<div class="col-xl-8 col-lg-8 col-sm-8">
				<div class="wrapper">
					<div class="search-input">
						<a href="" target="_blank" hidden></a>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Filter Subdomains" aria-label="Filter Subdomains" id="subdomains-search">
							<div class="input-group-append">
								<button id="subdomain-search-button" class="btn btn-primary" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> Search</button>
							</div>
						</div>
						<div class="autocom-box mt-container mx-auto" id="autocom-box">
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-4">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col-12">
								<div class="btn-group mb-2 float-end dropstart">
									<button class="btn btn-primary dropdown-toggle " data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<i class="fe-download"></i>
									</button>
									<div class="dropdown-menu" style="">
										<a class="dropdown-item" href="javascript:download_subdomains({{scan_history_id}}, '{{history.domain.name}}')">Download All Subdomains</a>
										<a class="dropdown-item" href="javascript:download_interesting_subdomains({{scan_history_id}}, '{{history.domain.name}}');">Download Interesting Subdomains</a>
										<a class="dropdown-item" href="javascript:download_important_subdomains({{scan_history_id}}, '{{history.domain.name}}');">Download Important Subdomains</a>
									</div>
								</div>
							</div>
							<div class="col-12">
								<table id="subdomain_scan_results" class="table style-3 table-hover">
									<thead>
										<tr>
											<th class="checkbox-column">Status</th>
											<th>Subdomain</th>
											<th class="text-center">Endpoints</th>
											<th class="text-center">Vulnerabilities</th>
											<th>Status</th>
											<th class="text-center">Title</th>
											<th>IP Address</th>
											<th>Ports</th>
											<th>Content Length</th>
											<th>Screenshot</th>
											<th>Response Time</th>
											<th>Technology</th>
											<th>Checked</th>
											<th>HTTP URL</th>
											<th>CNAME</th>
											<th>is_interesting</th>
											<th>Info</th>
											<th>Low</th>
											<th>Medium</th>
											<th>High</th>
											<th>Critical</th>
											<th>Todos</th>
											<th>Is Important</th>
											<th>Webserver</th>
											<th>Content Type</th>
											<th>Action</th>
										</tr>
									</thead>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% if history.screenshot %}
	<div class="tab-pane" id="screenshot-tab">
		<div class="col-lg-8 col-md-8 col-sm-9 filtered-list-search mx-auto">
			<input type="text" class="form-control form-control-lg br-30 mb-3" id="screenshot-search" placeholder="">
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="p-2">
						<div class="row" id="filter-screenshot" style="display: none;">
							<div class="col-xl-6 col-lg-6 col-sm-6">
								<h5 class=""><i class="fe-filter text-primary"></i> Filter Screenshots</h5>
							</div>
							<div class="col-xl-6 col-lg-6 col-sm-6">
								<div class="float-end">
									<a class="arrow-none waves-effect waves-light" data-toggle="fullscreen" href="#">
										<i class="fe-maximize noti-icon"></i>
									</a>
								</div>
							</div>
							<div class="row">
								<div class="col-xl-2 col-lg-4 col-sm-12">
									<label for="http_select_filter" class="form-label">HTTP Status</label>
									<select class="form-control tagging" id="http_select_filter" multiple="multiple" data-width="100%">
									</select>
								</div>
								<div class="col-xl-2 col-lg-4 col-sm-12">
									<label for="ips_select_filter" class="form-label">IP Address</label>
									<select class="form-control tagging" id="ips_select_filter" multiple="multiple" data-width="100%">
									</select>
								</div>
								{% if history.port_scan %}
								<div class="col-xl-2 col-lg-4 col-sm-12">
									<label for="services_select_filter" class="form-label">Running Services</label>
									<select class="form-control tagging" id="services_select_filter" multiple="multiple" data-width="100%">
									</select>
								</div>
								<div class="col-xl-2 col-lg-4 col-sm-12">
									<label for="ports_select_filter" class="form-label">Ports</label>
									<select class="form-control tagging" id="ports_select_filter" multiple="multiple" data-width="100%">
									</select>
								</div>
								{% endif %}
								<div class="col-xl-2 col-lg-4 col-sm-12">
									<label for="tech_select_filter" class="form-label">Technology</label>
									<select class="form-control tagging" id="tech_select_filter" multiple="multiple" data-width="100%">
									</select>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col-12">
								<div id="screenshot-loader">
									<div class="outer-div d-flex justify-content-center">
										<div class="spinner-grow text-primary m-2"></div>
									</div>
									<h5 class="text-center mt-3">Loading Screenshots...</h5>
								</div>
							</div>
							<div class="col-12">
								<div class="gridzy">
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% endif %}

	{# endpoints section #}
	<div class="tab-pane" id="endpoints-tab">
		<div class="row justify-content-center">
			<div class="col-xl-8 col-lg-8 col-sm-8">
				<div class="wrapper">
					<div class="search-input" id="endpoint-search-input">
						<a href="" target="_blank" hidden></a>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Filter Endpoints" aria-label="Filter Endpoints" id="endpoints-search">
							<div class="input-group-append">
								<button id="endpoint-search-button" class="btn btn-primary" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> Search</button>
							</div>
						</div>
						<div class="autocom-box mt-container mx-auto endpoint-search" id="autocom-box">
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-4">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col-12">
								<div class="btn-group mb-2 float-end dropstart">
									<button class="btn btn-primary dropdown-toggle " data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<i class="fe-download"></i>
									</button>
									<div class="dropdown-menu" style="">
										<a class="dropdown-item" href="javascript:download_endpoints({{scan_history_id}}, '{{history.domain.name}}')">Download All Endpoints</a>
										{% if history.fetch_url and history.used_gf_patterns%}
										{% for key,value in matched_gf_count.items %}
										{% if value > 0 %}
										<a class="dropdown-item" href="javascript:download_endpoints({{scan_history_id}}, '{{history.domain.name}}', '{{key}}')">Download Endpoints with pattern {{key|upper}}</a>
										{% endif %}
										{% endfor %}
										{% endif %}
									</div>
								</div>
							</div>
							<div class="col-12">
								<table id="endpoint_results" class="table style-3 table-hover">
									<thead>
										<tr>
											<th>ID</th>
											<th>HTTP URL</th>
											<th>Status</th>
											<th>Page Title</th>
											<th>Tags</th>
											<th>Content Type</th>
											<th>Content Length</th>
											<th>Technology</th>
											<th>Webserver</th>
											<th>Response time</th>
										</tr>
									</thead>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	{# directories section #}
	{% if history.dir_file_search %}
	<div class="tab-pane" id="directories-tab">
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<table id="directories-table" class="table style-3 table-hover">
							<thead>
								<tr>
									<th class="checkbox-column">Status</th>
									<th>Subdomain</th>
									<th>Status</th>
									<th>Page Title</th>
									<th>Directories</th>
									<th>HTTP URL</th>
									<th>Is Intereting</th>
									<th>Checked</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% endif %}

	{# Vulnerabilities Section #}
	{% if history.vulnerability_scan %}
	<div class="tab-pane" id="vulnerabilities-tab">
		<div class="row justify-content-center">
			<div class="col-xl-8 col-lg-8 col-sm-8">
				<div class="wrapper">
					<div class="search-input" id="vulnerability-search-input">
						<a href="" target="_blank" hidden></a>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Filter Vulnerabilities" aria-label="Filter Vulnerabilities" id="vulnerability-search">
							<div class="input-group-append">
								<button id="vulnerability-search-button" class="btn btn-primary" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> Search</button>
							</div>
						</div>
						<div class="autocom-box mt-container mx-auto" id="autocom-box">
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<table id="vulnerability_results" class="table style-3 table-hover">
							<thead>
								<tr>
									<th class="checkbox-column">Status</th>
									<th>Title</th>
									<th class="text-center">Severity</th>
									<th>Vulnerable URL</th>
									<th>Description</th>
									<th>Status</th>
									<th>Matcher Name</th>
									<th>Discovered Date</th>
									<th>Tags</th>
									<th>Description</th>
									<th>Reference</th>
									<th class="text-center dt-no-sorting">Action</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% endif %}

	{# OSINT Section #}
	{% if history.osint %}
	<div class="tab-pane" id="osint-tab">
		<div class="row">
			<div class="col-xl-5 col-lg-5 col-md-12 col-sm-12 col-12">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">
							<span id="employees-count">
								<span class="spinner-border spinner-border-sm me-1"></span>
							</span>
							Employees/People associated with {{history.domain.name}}
						</h4>
						<table class="table mt-3">
							<thead class="table-light">
								<tr>
									<th><div class="th-content">Employee Name</div></th>
									<th><div class="th-content">Designation</div></th>
								</tr>
							</thead>
							<tbody id="employees-table-body">
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="col-xl-7 col-lg-7 col-md-12 col-sm-12 col-12">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">
							<span id="emails-count">
								<span class="spinner-border spinner-border-sm me-1"></span>
							</span>
							Discovered Email addresses  <span id="exposed_summary" class="text-danger"></span>
						</h4>
						<table class="table mt-3">
							<thead class="table-light">
								<tr>
									<th><div class="th-content">Email Address</div></th>
									<th><div class="th-content">Esposed Credentials</div></th>
								</tr>
							</thead>
							<tbody id="email-table-body">
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">
							<span id="metadata-count">
								<span class="spinner-border spinner-border-sm me-1"></span>
							</span>
							Discovered Metadata
						</h4>
						<table class="table mt-3">
							<thead class="table-light">
								<tr>
									<th><div class="th-content">Document</div></th>
									<th><div class="th-content text-center">User</div></th>
									<th><div class="th-content text-center">Metadata</div></th>
								</tr>
							</thead>
							<tbody id="metadata-table-body">
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">
							<span id="dorks-count">
								<span class="spinner-border spinner-border-sm me-1"></span>
							</span>
							Dork Data
						</h4>
						<table class="table mt-3">
							<thead class="table-light">
								<tr>
									<th><div class="th-content text-center">Dork Type</div></th>
									<th><div class="th-content text-center">Description</div></th>
									<th><div class="th-content">URL</div></th>
								</tr>
							</thead>
							<tbody id="dorks-table-body">
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% endif %}

	{# visualisation section #}
	<div class="tab-pane" id="visualisation-tab">
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<div id="visualisation-filter" style="display:none">
							<div class="row">
								<div class="col-6">
									<div class="form-check form-switch">
										<input type="checkbox" class="form-check-input" name="expand-nodes-checkbox" checked>
										<label class="form-check-label" for="customSwitch1">&nbsp; &nbsp; Expand all nodes</label>
									</div>
								</div>
								<div class="col-6">
									<div class="dropdown float-end">
										<a href="#" class="dropdown-toggle arrow-none card-drop" data-bs-toggle="dropdown" aria-expanded="false">
											<i class="mdi mdi-dots-vertical"></i>
										</a>
										<div class="dropdown-menu dropdown-menu-end" style="">
											<a href="#" class="dropdown-item" id="saveButton">Download Visualization as png</a>
										</div>
									</div>
								</div>
							</div>
						</div>
						<hr>
						<div id="visualisation-loader">
							<div class="d-flex justify-content-center" id="visualisation-loader">
								<div class="spinner-border" role="status">
									<span class="visually-hidden">Loading...</span>
								</div>
							</div>
							<h5 class="text-center mt-3">Loading Recon Visualization...</h5>
						</div>
						<div class="row">
							<div class="col-10">
								<div id="visualisation">
								</div>
							</div>
							<div class="col-2">
								<div class="float-end m-3">
									<small class="text-success text-right"style="display: block;">*Subdomains highlighted with green are 20X (OK) HTTP status</small>
									<small class="text-warning text-right"style="display: block;">*Subdomains highlighted with orange are 30X (Redirect) HTTP status</small>
									<small class="text-danger text-right" style="display: block;">*Subdomains highlighted with red are 40X (Not found) HTTP status</small>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	{# Interesting Recon section #}
	<div class="tab-pane interesting-tab-show" style="display: none" id="interesting-tab">
		<div class="row">
			<div class="col-xl-12">
				<div class="card" id="interesting_subdomain_div">
					<div class="card-body">
						<div class="dropdown float-end">
							<a href="#" class="dropdown-toggle arrow-none card-drop" data-bs-toggle="dropdown" aria-expanded="false">
								<i class="mdi mdi-dots-vertical"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-end">
								<a class="dropdown-item" href="javascript:download_interesting_subdomains({{scan_history_id}}, '{{history.domain.name}}');">Download Interesting Subdomains</a>
							</div>
						</div>
						<h4 class="header-title mb-0"><span id="interesting_subdomain_count_badge"><span class="spinner-border spinner-border-sm me-1"></span></span> Interesting Subdomains</h4>
						<table id="interesting_subdomains" class="table style-3 table-hover">
							<thead>
								<tr>
									<th>Subdomain</th>
									<th>Page Title</th>
									<th>HTTP Status</th>
									<th>Content Length</th>
									<th>HTTP URL</th>
									<th>Tech Stack</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
			<div class="col-xl-12" id="interesting_endpoint_div">
				<div class="card">
					<div class="card-body">
						<div class="dropdown float-end">
							<a href="#" class="dropdown-toggle arrow-none card-drop" data-bs-toggle="dropdown" aria-expanded="false">
								<i class="mdi mdi-dots-vertical"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-end">
								<a class="dropdown-item" href="javascript:download_interesting_endpoints({{scan_history_id}}, '{{history.domain.name}}');">Download Interesting Endpoints</a>
							</div>
						</div>
						<h4 class="header-title mb-0"><span id="interesting_endpoint_count_badge"><span class="spinner-border spinner-border-sm me-1"></span></span> Interesting Endpoints</h4>
						<table id="interesting_endpoints" class="table style-3 table-hover">
							<thead>
								<tr>
									<th>URL</th>
									<th>Title</th>
									<th>HTTP Status</th>
									<th>Content Length</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

	{# Recon Data Changes section #}
	<div class="tab-pane recon-changes-tab-show" id="recon-changes-tab" style="display: none">
		<div class="row">
			<div class="col-xl-12">
				<div class="card" id="recon_changes_subdomain_div">
					<div class="card-body">
						<h4 class="header-title mb-0"><span id="subdomain_change_count"><span class="spinner-border spinner-border-sm me-1"></span></span> Subdomain Changes</h4>
						<table class="table style-3 table-hover" id="table-subdomain-changes">
							<thead>
								<tr>
									<th>Subdomain</th>
									<th>Page Title</th>
									<th>Status</th>
									<th>Content Length</th>
									<th>Change</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
			<div class="col-xl-12" id="endpoint-changes-div">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0"><span id="endpoint_change_count"><span class="spinner-border spinner-border-sm me-1"></span></span> Endpoint Changes</h4>
						<table class="table style-3 table-hover" id="table-endpoint-changes">
							<thead>
								<tr>
									<th>Subdomain</th>
									<th>Page Title</th>
									<th>Status</th>
									<th>Content Length</th>
									<th>Change</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

</div>

{# add recon note modal #}
<div class="modal fade" id="addSubdomainTaskModal" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Add Todo for <span id="todo-modal-subdomain-name"></span></h4>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="compose-box">
					<div class="compose-content" id="addTaskModalTitle">
						<form>
							<div class="row">
								<div class="col-md-12">
									<div class="d-flex mail-to mb-4">
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-3 flaticon-notes"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
										<div class="w-100 ms-2">
											<input id="subdomainTodoTitle" type="text" placeholder="Todo Title" class="form-control" name="task">
										</div>
									</div>
								</div>
							</div>

							<div class="d-flex  mail-subject mb-4">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text flaticon-menu-list"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
								<div class="w-100 ms-2">
									<textarea class="form-control" id="subdomainTodoDescription" rows="5" spellcheck="false" placeholder="Recon Todo/Note"></textarea>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" id="add-todo-subdomain-submit-button">Add Recon Todo</button>
			</div>
		</div>
	</div>
</div>

{# SubScan Modal #}
<div id="subscan-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="standard-modalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title" id="standard-modalLabel">Initiate Subscan</h4>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="alert alert-info">
					reNgine will use the configuration from Engine: <b>{{history.scan_type.engine_name}}</b> for this subscan. You can <a href="/scanEngine/update/{{history.scan_type.id}}" target="_blank">change the configuration for the engine here.</a>
				</div>
				<h5>Select the subtasks to perform</h5>
				<div class="mt-1">
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="port_scan_subtask">
						<label class="form-check-label" for="port_scan_subtask">Port Scan</label>
					</div>
				</div>
				<div class="mt-1">
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="osint_subtask">
						<label class="form-check-label" for="osint_subtask">OSINT</label>
					</div>
				</div>
				<div class="mt-1">
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="endpoint_subtask">
						<label class="form-check-label" for="endpoint_subtask">Endpoint Gathering</label>
					</div>
				</div>
				<div class="mt-1">
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="dir_fuzz_subtask">
						<label class="form-check-label" for="dir_fuzz_subtask">Directory Fuzzing</label>
					</div>
				</div>
				<div class="mt-1">
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="vuln_subtask">
						<label class="form-check-label" for="vuln_subtask">Vulnerability Scan</label>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="btn-initiate-subtask"><i class="fe-zap ms-1 me-1"></i>Initiate Subscan</button>
			</div>
		</div>
	</div>
</div>

{# for passing subdomain id to initiate subtask scan #}
<input type="hidden" name="subtask_subdomain_id" id="subtask_subdomain_id" value="0">

{% endblock main_content %}

{% block page_level_script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.29.0/apexcharts.min.js" integrity="sha512-fe6OklXva8AWoqdwgkE7Ni4uWgHGWxFQWZx4lYehzY2Qrst5YfogjAbnLd6egsoTrnjGI9/LYt1Ont2cKNbP2A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://apexcharts.com/samples/assets/irregular-data-series.js"></script>
<script src="https://apexcharts.com/samples/assets/ohlc.js"></script>
<script src="{% static 'custom/todo.js' %}"></script>
<script src="{% static 'note/js/todo.js' %}"></script>
<script src="{% static 'startScan/js/detail_scan.js' %}"></script>
<script src="{% static 'plugins/datatable/datatables.js' %}"></script>
<script src="{% static 'plugins/lightbox/js/lightbox.js' %}"></script>
<script src="{% static 'plugins/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
<script src="{% static 'assets/js/clipboard.min.js' %}"></script>
<script src="{% static 'plugins/select2/select2.min.js' %}"></script>
{# search suggestions scripts #}
<script src="{% static 'startScan/js/subdomains-suggestions.js' %}"></script>
<script src="{% static 'startScan/js/endpoint-datatables-suggestions.js' %}"></script>

{% if history.vulnerability_scan %}
<script src="{% static 'startScan/js/vulnerability-datatables-suggestions.js' %}"></script>
{% endif %}

{# visualisation libraries #}
<script src="{% static 'custom/mitch.js' %}"></script>

<script type="text/javascript">
$(document).ready(function(){
	// init
	const ps = new PerfectScrollbar(document.querySelector('.mt-container'));
	const ps1 = new PerfectScrollbar(document.querySelector('.endpoint-search'));
	$('[data-toggle="tooltip"]').tooltip();
	$('#addTaskModal select').css('width', '100%');
	$("#todoSubdomainDropdown").select2({
		dropdownParent: $('#addTaskModal')
	});
	var clipboard = new Clipboard('.copyable');

	// $(".tagging").select2({
	// 	tags: true
	// });

	//populate charts
	// vulnerability summary pie chart
	{% if history.vulnerability_scan %}
	var options = {
		chart: {
			type: 'donut',
			height: 280,
		},
		colors: ['#D50000', '#F44336', '#FF6D00', '#FFD600', '#2962FF'],
		dataLabels: {
			enabled: false
		},
		legend: {
			show: !0,
			position: "bottom",
			horizontalAlign: "center",
			verticalAlign: "middle",
			floating: !1,
			fontSize: "15px",
			offsetX: 0,
			offsetY: 7
		},
		plotOptions: {
			pie: {
				donut: {
					size: '70%',
					background: 'transparent',
					labels: {
						show: true,
						name: {
							show: true,
							fontSize: '29px',
							fontFamily: 'Nunito, sans-serif',
							color: undefined,
							offsetY: -10
						},
						value: {
							show: true,
							fontSize: '26px',
							fontFamily: 'Nunito, sans-serif',
							color: '20',
							offsetY: 16,
							formatter: function (val) {
								return val
							}
						},
						total: {
							show: true,
							showAlways: true,
							label: 'Total',
							color: '#888ea8',
							formatter: function (w) {
								return w.globals.seriesTotals.reduce( function(a, b) {
									return a + b
								}, 0)
							}
						}
					}
				}
			}
		},
		series: [{{critical_count}}, {{high_count}}, {{medium_count}}, {{low_count}}, {{info_count}}],
		labels: ['Critical', 'High', 'Medium', 'Low', 'Info'],
		responsive: [{
			breakpoint: 1599,
			options: {
				chart: {
					height: 240
				},
				legend: {
					position: 'bottom'
				}
			},
			breakpoint: 1439,
			options: {
				chart: {
					width: '250px',
					height: '390px'
				},
			},
		}],
	}

	var chart = new ApexCharts(
		document.querySelector("#vulnerability-pie-chart"),
		options
	);

	chart.render()
	{% endif %}

	// depending on http_status_breakdown, generate color
	var colors = [
		{% for status in http_status_breakdown %}
		{% if status.http_status >= 200 and status.http_status < 300 %}
		'#4CAF50',
		{% elif status.http_status >= 300 and status.http_status < 400 %}
		'#FFC107',
		{% else %}
		'#F44336',
		{% endif %}
		{% endfor %}
	];

	// http_status chart
	var options = {
		series: [{
			name: 'Subdomains',
			data: [{% for status in http_status_breakdown %}
				{{status.http_status__count}},
				{% endfor %}]
			}],
			chart: {
				height: 350,
				type: 'bar',
				events: {
					click: function(chart, w, e) {
						// console.log(chart, w, e)
					}
				}
			},
			colors: colors,
			plotOptions: {
				bar: {
					columnWidth: '45%',
					distributed: true,
				}
			},
			dataLabels: {
				enabled: false
			},
			legend: {
				show: false
			},
			xaxis: {
				categories: [
					{% for status in http_status_breakdown %}
					'{{status.http_status}}',
					{% endfor %}
				],
				labels: {
					style: {
						colors: colors,
						fontSize: '12px'
					}
				}
			}
		};

		var chart = new ApexCharts(document.querySelector("#http_status_chart"), options);
		chart.render();

		//populate widgets
		get_important_subdomains(null, {{scan_history_id}});
		get_recon_notes(null, {{scan_history_id}});
		get_ips({{scan_history_id}});
		get_technologies({{scan_history_id}});
		get_ports({{scan_history_id}});

		// if clicked on pills get subdomains
		// $("#pills-subdomain-tab").click(function() {
		var subdomain_datatables = $('#subdomain_scan_results').DataTable({
			"destroy": true,
			"processing": true,
			"oLanguage": {
				"oPaginate": { "sPrevious": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>', "sNext": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>' },
				"sInfo": "Showing page _PAGE_ of _PAGES_",
				"sSearch": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
				"sSearchPlaceholder": "Search...",
				"sLengthMenu": "Results :  _MENU_",
			},
			"stripeClasses": [],
			"lengthMenu": [50, 100, 500, 1000],
			"pageLength": 50,
			'serverSide': true,
			"ajax": '/api/listDatatableSubdomain/?scan_id={{scan_history_id}}&format=datatables',
			"order": [[ 8, "desc" ]],
			"columns": [
				{'data': 'id'},
				{'data': 'name'},
				{'data': 'endpoint_count'},
				{'data': 'endpoint_count'},
				{'data': 'http_status'},
				{'data': 'page_title'},
				{'data': 'ip_addresses'},
				{'data': 'ip_addresses'},
				{'data': 'content_length', 'searchable': false},
				{'data': 'screenshot_path', 'searchable': false},
				{'data': 'response_time'},
				{'data': 'technologies'},
				{'data': 'http_url'},
				{'data': 'cname'},
				{'data': 'is_interesting'},
				{'data': 'info_count'},
				{'data': 'low_count'},
				{'data': 'medium_count'},
				{'data': 'high_count'},
				{'data': 'critical_count'},
				{'data': 'todos_count'},
				{'data': 'is_important'},
				{'data': 'webserver'},
				{'data': 'content_type'},
				{'data': 'id'},
			],
			"columnDefs": [
				{ "orderable": false, "targets": [2, 3, 6, 7, 9]},
				{
					"targets": [ 2, 3, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21],
					"visible": false,
					"searchable": false,
				},
				{
					"targets": [ 11, 13, 21, 22, 23 ],
					"visible": false,
					"searchable": true,
				},
				{"className": "text-center", "targets": [2, 3, 4, 8, 10]},
				// checkbox
				{
					"render": function ( data, type, row ) {
						if(row['checked']){
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" checked name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="subdomain_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
						else{
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="subdomain_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
					},
					"targets": 0,
				},
				// subdomain Name
				{
					"render": function ( data, type, row ) {
						badges = '';
						tech_badge = '';
						interesting_badge = '';
						content_type = '';
						web_server = '';
						if (row['technologies']){
							tech_badge = `</br>` + parse_technology(row['technologies'], "primary", outline=true, scan_id={{scan_history_id}});
						}
						if(row['is_interesting'])
						{
							interesting_badge = `<span class='ms-1 me-1 badge badge-soft-danger' data-toggle="tooltip" data-placement="top" title="Interesting Subdomain">Interesting</span>`;
						}

						if (row['content_type']) {
							content_type = `<span class='m-1 badge badge-soft-blue bs-tooltip' title="Content Type">${row['content_type']}</span>`;
						}

						if (row['webserver']) {
							web_server = `<span class='m-1 badge badge-soft-info bs-tooltip' title="Web Server">${row['webserver']}</span>`;
						}

						badges =   interesting_badge + '</br>';

						todo_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#e7515a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`;
						todo_badge = '';

						if (row['todos_count']) {
							todo_badge = `<span class="text-danger badge badge-link badge-soft-danger m-1" onclick="list_subdomain_todos(${row['id']}, '${row['name']}')">${todo_icon}&nbsp;${row['todos_count']} Todos&nbsp;</span>`
						}

						important_badge = '';
						if (row['is_important']) {
							important_badge = `
							<span id="important_subdomain_${row['id']}" class="text-danger bs-tooltip" data-toggle="tooltip" data-placement="top" title="Important Subdomain">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
							</span>
							`;
						}

						endpoint_count_badge = '';
						if (row['endpoint_count']) {
							endpoint_count_badge = `<span class="pl-2 pr-2 ml-1 mr-1 float-end badge badge-soft-primary badge-link bs-tooltip" title="Endpoints" onclick="get_endpoint_modal({{history.id}}, '${row['name']}')">${row['endpoint_count']}</span>`
						}

						vuln_count_badge = '';
						info_badge = `<span class='pl-2 pr-2 ml-1 mr-1 float-end badge badge-info bs-tooltip badge-link' title="Informational Vulnerabilities" onclick="get_vulnerability_modal({{history.id}}, 0, '${row['name']}')">${row['info_count']}</span>`;
						low_badge = `<span class='pl-2 pr-2 ml-1 mr-1 float-end badge badge-low bs-tooltip badge-link' title=" Low Severity Vulnerabilities" onclick="get_vulnerability_modal({{history.id}}, 1, '${row['name']}')">${row['low_count']}</span>`;
						medium_badge = `<span class='pl-2 pr-2 ml-1 mr-1 float-end badge badge-soft-warning bs-tooltip badge-link' title="Medium Severity Vulnerabilities" onclick="get_vulnerability_modal({{history.id}}, 2, '${row['name']}')">${row['medium_count']}</span>`;
						high_badge = `<span class='pl-2 pr-2 ml-1 mr-1 float-end badge badge-soft-danger bs-tooltip badge-link' title="High Severity Vulnerabilities" onclick="get_vulnerability_modal({{history.id}}, 3, '${row['name']}')">${row['high_count']}</span>`;
						critical_badge = `<span class='pl-2 pr-2 ml-1 mr-1 float-end badge badge-critical bs-tooltip badge-link' title="Critical Vulnerabilities" onclick="get_vulnerability_modal({{history.id}}, 4, '${row['name']}')">${row['critical_count']}</span>`;
						vuln_count_badge =  (row['info_count'] > 0? info_badge : '') + (row['low_count'] > 0? low_badge : '') + (row['medium_count'] > 0? medium_badge : '') + (row['high_count'] > 0? high_badge : '') + (row['critical_count'] > 0? critical_badge : '');

						action_icons = `
						<br />
						<div class="float-left subdomain-table-action-icons mt-2">
						<span class="m-1">
						<a href="javascript:;" data-clipboard-action="copy" class="badge-link text-primary copyable text-primary" data-toggle="tooltip" data-placement="top" title="Copy Subdomain!" data-clipboard-target="#subdomain-${row['id']}" id="#subdomain-${row['id']}" onclick="setTooltip(this.id, 'Copied!')">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></span>
						</a>
						<span class="m-1 badge-link text-success bs-tooltip" title="Add Recon Todo/Note" onclick="add_task_for_subdomain(${row['id']}, '${data}')"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg></span>
						<span class="m-1 badge-link text-danger bs-tooltip" title="Mark Important" onclick="mark_important_subdomain(row=this, subdomain_id=${row['id']})">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
						</span>
						</div>
						`;

						tech_badge += content_type;
						tech_badge += web_server;

						if (row['http_url']) {
							if (row['cname']) {
								return badges + `<div class="clipboard copy-txt"><a href="`+row['http_url']+`" class="text-primary" target="_blank"><span id='subdomain-${row['id']}'>`+ important_badge + data  +`</span></a>`+ endpoint_count_badge + vuln_count_badge +`<br><span class="text-dark">CNAME<br><span class="text-warning"> ❯ </span>` + row['cname'].replace(',', '<br><span class="text-warning"> ❯ </span>') + tech_badge + todo_badge + action_icons + `</div>`;
							}
							return badges + `<div class="clipboard copy-txt"><a href="`+row['http_url']+`" class="text-primary" target="_blank"><span id='subdomain-${row['id']}'>`+ important_badge + data + `</span></a>` + endpoint_count_badge + vuln_count_badge + tech_badge + todo_badge + action_icons + `</div>`;
						}
						return badges + `<div class="clipboard copy-txt"><a href="https://`+data+`" class="text-primary" target="_blank"><span id='subdomain-${row['id']}'>`+ important_badge + data + `</span></a>` + endpoint_count_badge + vuln_count_badge + tech_badge + todo_badge + action_icons + `</div>`;
					},
					"targets": 1
				},
				// http_status
				{
					"render": function ( data, type, row ) {
						// display badge based on http status
						// green for http status 2XX, orange for 3XX and warning for everything else
						if (data >= 200 && data < 300) {
							return "<span class='badge bg-success'>"+data+"</span>";
						}
						else if (data >= 300 && data < 400) {
							return "<span class='badge bg-warning'>"+data+"</span>";
						}
						else if (data == 0){
							// datatable throws error when no data is returned
							return "";
						}
						return `<span class='badge bg-danger'>`+data+`</span>`;
					},
					"targets": 4,
				},
				// page title
				{
					"render": function ( data, type, row ) {
						if (data){
							return htmlEncode(data);
						}
						return "";
					},
					"targets": 5,
				},
				// ip address
				{
					"render": function ( data, type, row ) {
						ip_badge = ''
						if (data)
						{
							Object.entries(data).forEach(([key, value]) => {
								if (value['is_cdn']) {
									ip_badge += `<span class='m-1 badge badge-soft-warning badge-link' title="CDN IP Address" onclick="get_ip_details('${value.address}', {{scan_history_id}})">${value.address}</span>`
								}
								else{
									ip_badge += `<span class='m-1 badge badge-soft-primary badge-link' onclick="get_ip_details('${value.address}', {{scan_history_id}})">${value.address}</span>`
								}
							});
							return ip_badge;
						}
						return "";
					},
					"targets": 6,
				},
				// open ports
				{
					"render": function ( data, type, row ) {
						port_badge = ''
						if (data){
							for (ip in data){
								ports = data[ip]['ports']
								for (port in ports){
									port_obj = data[ip]['ports'][port]
									badge_color = port_obj['is_uncommon'] ? 'danger' : 'primary';
									title = port_obj['is_uncommon'] ? 'Uncommon Port - ' + port_obj['description'] : port_obj['description'];
									port_badge += `<span class='m-1 badge badge-soft-${badge_color} bs-tooltip badge-link' title='${title}' onclick="get_port_details(${port_obj['number']}, {{scan_history_id}})">${port_obj['number']}/${port_obj['service_name']}</span>`
								}
							}
							return port_badge;
						}
						return "";
					},
					"targets": 7,
				},
				// screenshot
				{
					"render": function ( data, type, row ) {
						if (data){
							//return lightbox with caption as http link
							return `<a href="/media/`+data+`" data-lightbox="screenshots" data-title="&lt;a target='_blank' href='`+row['http_url']+`'&gt;&lt;h3 style=&quot;color:white&quot;&gt;`+row['name']+`&lt;/h3&gt;&lt;/a&gt;"><img src="/media/`+data+`" class="img-fluid rounded mb-4 mt-4 screenshot" onerror="removeImageElement(this)"></a>`;
						}
						return "";
					},
					"targets": 9,
				},
				// response_time
				{
					"render": function ( data, type, row ) {
						if (data){
							return get_response_time_text(data);
						}
						return "";
					},
					"targets": 10,
				},
				// Action
				{
					"render": function ( data, type, row ) {
						return `
						<div class="mt-2">
						<a href="javascript:void(0);" class="action-icon btn-scan-subdomain" data-toggle="tooltip" data-placement="top" title="Further Scan Subdomain" id="${row['id']}"> <i class="mdi mdi-lightning-bolt-outline"></i></a>
						<a href="javascript:void(0);" class="action-icon btn-delete-subdomain" data-toggle="tooltip" data-placement="top" title="Delete Subdomain" id="${row['id']}"> <i class="mdi mdi-delete"></i></a>
						</div>
						`;
					},
					"targets": 25,
				},
			],
			"dom": "<'row'<'col-lg-12 col-md-12 col-12 mb-2'l>>" +
			"<'table-responsive'tr>" +
			"<'dt--bottom-section d-sm-flex justify-content-sm-between text-center'<'dt--pages-count  mb-sm-0 mb-3'i><'dt--pagination'p>>",
			drawCallback: function () {
				$('.badge').tooltip({ template: '<div class="tooltip status" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>' })
				$('.bs-tooltip').tooltip();
				// get screenshot size from localStorage
				var elements = document.getElementsByClassName("screenshot");
				screenshot_size = localStorage.getItem('screenshotSize');
				if (screenshot_size){
					for (index = 0; index < elements.length; ++index) {
						elements[index].setAttribute("height", screenshot_size);
						elements[index].setAttribute("width", screenshot_size);
					}
				}
				else{
					for (index = 0; index < elements.length; ++index) {
						elements[index].setAttribute("height", "200px");
						elements[index].setAttribute("width", "200px");
					}
				}
			},
			'createdRow': function( row, data, dataIndex ) {
				if (data['is_important']){
					$(row).addClass('table-danger');
				}
			},
		});

		$('#subdomain-search-button').click(function () {
			subdomain_datatables.search($("#subdomains-search").val()).draw() ;
		});

		$("#subdomain_scan_results").on('click', '.btn-delete-subdomain', function () {
			var subdomain_id = $(this).attr('id');
			var data = {'subdomain_ids': [subdomain_id]};
			var row = this;
			Swal.fire({
				showCancelButton: true,
				title: 'Delete Subdomain!',
				text: 'Do you really want to delete this subdomain? This action cannot be undone.',
				icon: 'error',
				confirmButtonText: 'Delete',
			}).then((result) => {
				if (result.isConfirmed) {
					Swal.fire({
						title: 'Deleting Subdomain...',
						allowOutsideClick: false
					});
					swal.showLoading();
					fetch('/api/action/subdomain/delete/', {
						method: 'POST',
						credentials: "same-origin",
						headers: {
							"X-CSRFToken": getCookie("csrftoken"),
							'Content-Type': 'application/json'
						},
						body: JSON.stringify(data)
					})
					.then(response => response.json())
					.then(function (response) {
						swal.close();
						if (response['status']) {
							$(row).parent().parent().parent().remove();
							Snackbar.show({
								text: 'Subdomain successfully deleted!',
								pos: 'top-right',
								duration: 2500
							});
						}
						else{
							Swal.fire({
								title:  'Could not delete Subdomain!',
								icon: 'fail',
							});
						}
					});
				}
			});;
			$('a[data-toggle="tooltip"]').tooltip("hide")
		});

		$("#subdomain_scan_results").on('click', '.btn-scan-subdomain', function () {
			$('input[type=checkbox]').prop('checked',false);
			$('#subscan-modal').modal('show');
			var subdomain_id = $(this).attr('id');
			$('a[data-toggle="tooltip"]').tooltip("hide")
			$('#subtask_subdomain_id').val(subdomain_id);
		});

		// if port scanning is not done, remove port row
		var column = subdomain_datatables.column('7');
		{% if history.port_scan %}
		column.visible(true);
		{% else %}
		column.visible(false);
		{% endif %}

		// });
	});

	{% if history.screenshot %}
	//if clicked on get screenshots tab
	$("#pills-screenshot-tab").click(function() {
		get_screenshot({{scan_history_id}});

		//animate search placeholder
		const words = ["Search by Page Title   ",
		"Search by HTTP Status   ",
		"Search 'Interesting'   ",
		"Search by Subdomain Name   "]

		typingEffect(words, "screenshot-search", 0);
	});
	{% endif %}

	// default get urls
	$("#pills-endpoints-tab").click(function() {
		get_endpoints({{scan_history_id}}, null);
	});

	{% if history.fetch_url and history.used_gf_patterns %}
	// gf patterns
	{% for pattern in history.used_gf_patterns|split:"," %}
	$("#pills-{{pattern}}-tab").click(function() {
		get_endpoints({{scan_history_id}}, '{{pattern}}');
	});
	{% endfor %}
	{% endif %}

	{% if history.dir_file_search %}
	$("#pills-directories-tab").click(function() {
		var interesting_keywords_array = [];
		var directory_table = $('#directories-table').DataTable({
			"destroy": true,
			"oLanguage": {
				"oPaginate": { "sPrevious": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>', "sNext": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>' },
				"sInfo": "Showing page _PAGE_ of _PAGES_",
				"sSearch": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
				"sSearchPlaceholder": "Search...",
				"sLengthMenu": "Results :  _MENU_",
			},
			"processing": true,
			"stripeClasses": [],
			"lengthMenu": [20, 50, 100, 500, 1000],
			"pageLength": 20,
			'serverSide': true,
			"ajax": '/api/listDatatableSubdomain/?scan_id={{scan_history_id}}&format=datatables&only_directory',
			"order": [[ 5, "desc" ]],
			"columns": [
				{'data': 'id'},
				{'data': 'name'},
				{'data': 'http_status'},
				{'data': 'page_title'},
				{'data': 'directory_json'},
				{'data': 'http_url'},
				{'data': 'is_interesting'},
				{'data': 'checked'},
			],
			"columnDefs": [
				{
					"targets": [ 5, 6, 7],
					"visible": false,
					"searchable": false,
				},
				{
					"render": function ( data, type, row ) {
						if(row['checked']){
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" checked name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="subdomain_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
						else{
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="subdomain_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
					},
					"targets": 0,
				},
				{
					"render": function ( data, type, row ) {
						if (row['http_url']) {
							interesting_badge = '';
							if(row['is_interesting'])
							{
								interesting_badge = `<span class='me-1 badge badge-pills badge-soft-danger ms-1' data-toggle="tooltip" data-placement="top" title="Interesting Subdomain">Interesting</span>`;
							}
							return `<a href="`+row['http_url']+`" class="text-primary" target="_blank">`+data+`</a>`+interesting_badge+`<br>`;
						}
						return `<a href="https://`+data+`" class="text-primary" target="_blank">`+data+`</a>` + interesting_badge;
					},
					"targets": 1
				},
				{
					"render": function ( data, type, row ) {
						// display badge based on http status
						// green for http status 2XX, orange for 3XX and warning for everything else
						if (data >= 200 && data < 300) {
							return "<span class='badge badge-pills badge-soft-success'>"+data+"</span>";
						}
						else if (data >= 300 && data < 400) {
							return "<span class='badge badge-pills badge-soft-warning'>"+data+"</span>";
						}
						else if (data == 0){
							// datatable throws error when no data is returned
							return "";
						}
						return `<span class='badge badge-pills badge-soft-danger'>`+data+`</span>`;
					},
					"targets": 2,
				},
				{
					"render": function ( data, type, row ) {
						if (data){
							return htmlEncode(data);
						}
						return "";
					},
					"targets": 3,
				},
				{
					"render": function ( data, type, row ) {
						if (data) {
							data = JSON.parse(data);
							dir_data = data['results'];
							console.log(dir_data);
							var html_treeview = `<ul>`;
							dir_data.forEach(function(item){
								var interesting_badge = '';
								interesting_keywords_array.forEach(function(keyword){
									if (item.input.FUZZ.includes(keyword)) {
										interesting_badge = '<span class="badge badge-soft-danger ms-1 me-1" data-toggle="tooltip" data-placement="top" title="Interesting Directory">Interesting</span>';
										return;
									}
								});
								var http_status_badge = '';
								if (item.status >= 200 && item.status < 300) {
									http_status_badge = `<span class='badge badge-pills badge-soft-success' data-toggle="tooltip" data-placement="top" title="HTTP Status">`+item.status+`</span>`;
								}
								else if (item.status >= 300 && item.status < 400) {
									http_status_badge = `<span class='badge badge-pills badge-soft-warning' data-toggle="tooltip" data-placement="top" title="HTTP Status">`+item.status+`</span>`;
								}
								else{
									http_status_badge = `<span class='badge badge-pills badge-soft-danger' data-toggle="tooltip" data-placement="top" title="HTTP Status">`+item.status+`</span>`;
								}
								var http_url = item.url;
								html_treeview += `<li class="mt-1"><a href="` + http_url + `" target="_blank">` + item.input.FUZZ + ` (` + item.length/100 + ` Kb) <span class="badge badge-soft-primary" data-toggle="tooltip" data-placement="top" title="Content Type">(` + item['content-type'] + `)</span> ${http_status_badge}</a>${interesting_badge}</li>`;
							});
							html_treeview += `</ul>`;
							return html_treeview;
						}
						return '';
					},
					"targets": 4,
				},
			],
			"dom": "<'dt--top-section'<'row'<'col-12 col-sm-6 d-flex justify-content-sm-start justify-content-center'f><'col-12 col-sm-6 d-flex justify-content-sm-end justify-content-center'l>>>" +
			"<'table-responsive'tr>" +
			"<'dt--bottom-section d-sm-flex justify-content-sm-between text-center'<'dt--pages-count  mb-sm-0 mb-3'i><'dt--pagination'p>>",
			drawCallback: function () {
			},
			preDrawCallback: function () {
				return fetch("/api/listInterestingKeywords")
				.then(response => {
					return response.json();
				})
				.then(data => {
					interesting_keywords_array = data;
				});
			},
			initComplete: function( settings, json ) {
			},
			'createdRow': function( row, data, dataIndex ) {
				if (data['checked']){
					$(row).addClass('table-danger text-strike');
				}
			},
			"rowCallback": function( row, data, index ) {
				var data = JSON.parse(data['directory_json']);
				if (!data['results'].length) {
					$(row).hide();
				}
			},
		});
	});
	{% endif %}

	// vulnerability section
	{% if history.vulnerability_scan %}
	$("#pills-vulnerabilities-tab").click(function() {
		var vulnerability_table = $('#vulnerability_results').DataTable({
			"destroy": true,
			"oLanguage": {
				"oPaginate": { "sPrevious": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>', "sNext": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>' },
				"sInfo": "Showing page _PAGE_ of _PAGES_",
				"sSearch": '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
				"sSearchPlaceholder": "Search...",
				"sLengthMenu": "Results :  _MENU_",
			},
			"processing": true,
			"dom": "<'row'<'col-lg-12 col-md-12 col-12 mb-2'l>>" +
			"<'table-responsive'tr>" +
			"<'dt--bottom-section d-sm-flex justify-content-sm-between text-center'<'dt--pages-count  mb-sm-0 mb-3'i><'dt--pagination'p>>",
			"stripeClasses": [],
			"lengthMenu": [20, 50, 100, 500, 1000],
			"pageLength": 100,
			'serverSide': true,
			"ajax": '/api/listVulnerability/?scan_history={{scan_history_id}}&format=datatables',
			"order": [[ 2, "desc" ]],
			"columns": [
				{'data': 'id'},
				{'data': 'name'},
				{'data': 'severity'},
				{'data': 'http_url'},
				{'data': 'extracted_results'},
				{'data': 'open_status'},
				{'data': 'matcher_name'},
				{'data': 'discovered_date'},
				{'data': 'tags'},
				{'data': 'description'},
				{'data': 'reference'},
				{'data': 'hackerone_report_id'},
			],
			"columnDefs": [
				{ "orderable": false, "targets": [4, 9, 10, 11]},
				{
					"targets": [ 6, 7, 8, 9, 10 ],
					"visible": false,
					"searchable": true,
				},
				{"className": "text-center", "targets": [0, 2, 5, 11]},
				{
					"render": function ( data, type, row ) {
						if(row['open_status']){
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="vuln_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
						else{
							return `<div class="form-check mb-2 form-check-primary"><input type="checkbox" checked name="targets_checkbox['+ e + ']" class="float-start form-check-input" onchange="vuln_status_change(this, `+data+`);">\n<span class="new-control-indicator"></span><span style="visibility:hidden">c</span></div>`;
						}
					},
					"targets": 0,
				},
				{
					"render": function ( data, type, row ) {
						var tags_span ="";
						switch (row['severity']) {
							case 'Info':
							color = 'soft-info'
							break;
							case 'Low':
							color = 'soft-low'
							break;
							case 'Medium':
							color = 'soft-warning'
							break;
							case 'High':
							color = 'soft-danger'
							break;
							case 'Critical':
							color = 'critical'
							break;
							default:
						}
						if (row['tags']) {
							var badge = "<span class='badge badge-"+color+" m-1'>";
							row['tags'].split(/\s*,\s*/).forEach(function(split_vals) {
								tags_span+=badge + split_vals + "</span>";
							});
						}
						hackerone_report = row['hackerone_report_id'] ? `<br><a class="badge badge-soft-danger m-2" href="https://hackerone.com/reports/${row['hackerone_report_id']}" target="_blank">Reported to hackerone</a>` : "";
						return `<b class="text-${color}">` + data + `</b>` + `<br/>` + tags_span + hackerone_report + `<br><small>Discovered on: ` + row['discovered_date'] + "</small>";
					},
					"targets": 1,
				},
				{
					"render": function ( data, type, row ) {
						switch (data) {
							case 'Info':
							return "<span class='badge badge-soft-info'>Info</span>";
							break;
							case 'Low':
							return "<span class='badge badge-soft-low'>Low</span>";
							break;
							case 'Medium':
							return "<span class='badge badge-soft-warning'>Medium</span>";
							break;
							case 'High':
							return "<span class='badge badge-soft-danger'>High</span>";
							break;
							case 'Critical':
							return "<span class='badge badge-critical'>Critical</span>";
							break;
							default:
							return "";
						}
					},
					"targets": 2,
				},

				{
					"render": function ( data, type, row ) {
						return "<a href='"+htmlEncode(data)+"' target='_blank' class='text-danger'>"+htmlEncode(data)+"</a>";
					},
					"targets": 3,
				},
				{
					"render": function ( data, type, row ) {
						extracted_results = row['extracted_results'] ? row['extracted_results'] + `</br>` : "";
						matcher_name = row['matcher_name'] ? row['matcher_name'] + `</br>` : "";
						description = row['description'] ? row['description'] + `</br>` : "";
						reference = row['reference'] ? `<a href=${row['reference']} class='text-primary' target='_blank'>Read More...</a>` : "";
						return extracted_results + matcher_name + description + reference;
					},
					"targets": 4,
				},
				{
					"render": function ( data, type, row ) {
						if (data){
							return '<span class="badge badge-soft-danger">Open</span>'
						}
						else{
							return '<span class="badge badge-soft-success">Closed</span>'
						}
					},
					"targets": 5,
				},
				{
					"render": function ( data, type, row ) {
						if (!data){
							return `
							<div class="btn-group mb-2 dropstart">
							<a href="#" class="text-dark dropdown-toggle float-end" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
							</a>
							<div class="dropdown-menu" style="">
							<a class="dropdown-item" href="javascript:report_hackerone(${row['id']}, '${row['severity']}');">Report to Hackerone</a>
							</div>
							</div>`;
						}
						else{
							return '';
						}
					},
					"targets": 11,
				},
			],
			drawCallback: function () {
			},
			createdRow: function( row, data, dataIndex ) {
				if (!data['open_status']){
					$(row).addClass('table-success text-strike');
				}
			},
		});
		$('#vulnerability-search-button').click(function () {
			vulnerability_table.search($('#vulnerability-search').val()).draw() ;
		});
	});
	{% endif %}

	// get osint
	$("#pills-osint-tab").click(function() {
		get_metadata({{scan_history_id}});
		get_emails({{scan_history_id}});
		get_employees({{scan_history_id}});
		get_dorks({{scan_history_id}});
	});

	// visualisation tab
	$("#pills-visualisation-tab").click(function() {
		visualise_scan_results({{scan_history_id}});
	});

	// gets interesting subdomains
	get_interesting_subdomains(null, {{scan_history_id}});
	get_interesting_endpoint(null, {{scan_history_id}});

	// tab clicker
	$('#interesting-tab-btn').click(function(){
		$('.nav-tabs a[href="#interesting-tab"]').tab('show')
	});
	$('#recon-changes-tab-btn').click(function(){
		$('.nav-tabs a[href="#recon-changes-tab"]').tab('show')
	});

	// recon data changes
	get_subdomain_changes({{scan_history_id}});
	get_endpoint_changes({{scan_history_id}});

</script>
{% endblock page_level_script %}
